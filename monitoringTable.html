<!DOCTYPE html>
<html>
<head>
    <title>Non-Ticketing Activities</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        .readonly {
            background-color: #eee;
        }
    </style>
</head>
<body>
    <h2>Non-Ticketing Activities</h2>
    <table id="activitiesTable">
        <thead>
            <tr>
                <th>Activity</th>
                <th># Systems</th>
                <th class="readonly">Yearly Frequency</th>
                <th class="readonly">Effort/Event (hrs)</th>
                <th class="readonly">Monthly Frequency</th>
                <th>Monthly Efforts (hrs)</th>
                <th>FTE</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        const activities = [
            { activity: "SAP vulnerability analysis, reporting", systems: 13, yearly: 12, effort: 9 },
            { activity: "Production monitoring", systems: 17, yearly: 261, effort: 0.75 },
            { activity: "Prod monitoring (SaaS)", systems: 9, yearly: 261, effort: 0.25 },
            { activity: "Non prod monitoring", systems: 15, yearly: 52, effort: 0.75 },
            { activity: "Non-Prod monitoring (SaaS)", systems: 10, yearly: 52, effort: 0.25 },
            { activity: "System Refreshes", systems: 3, yearly: 2, effort: 45 },
            { activity: "SAP Kernel update/upgrade", systems: 14, yearly: 2, effort: 5 },
            { activity: "SPS Update/Patching Support", systems: 9, yearly: 2, effort: 55 },
            { activity: "DB Update/Patching Support", systems: 11, yearly: 2, effort: 18 },
            { activity: "Oracle/HANA Maintenance Support", systems: 0, yearly: 1, effort: 18 },
            { activity: "DR test Planning support", systems: 10, yearly: 1, effort: 18 },
            { activity: "SSL or external certificate with renewals", systems: 13, yearly: 1, effort: 4 },
            { activity: "Early Watch Alert analysis, reporting", systems: 10, yearly: 12, effort: 8 },
            { activity: "OS Patching support monthly", systems: 13, yearly: 4, effort: 6 },
            { activity: "Capacity planning for storage management", systems: 13, yearly: 1, effort: 4 }
        ];

        const tableBody = document.querySelector("#activitiesTable tbody");

        function calculateAndRenderTable() {
            tableBody.innerHTML = ""; // Clear existing rows
            let totalMonthlyEffort = 0;
            let totalFTE = 0;

            activities.forEach((item, index) => {
                const monthlyFreq = item.yearly / 12;
                const monthlyEffort = item.systems * item.effort * monthlyFreq;
                const fte = monthlyEffort / 160;

                totalMonthlyEffort += monthlyEffort;
                totalFTE += fte;

                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${item.activity}</td>
                    <td><input type="number" value="${item.systems}" data-index="${index}" /></td>
                    <td class="readonly">${item.yearly}</td>
                    <td class="readonly">${item.effort}</td>
                    <td class="readonly">${monthlyFreq.toFixed(2)}</td>
                    <td>${monthlyEffort.toFixed(2)}</td>
                    <td>${fte.toFixed(3)}</td>
                `;
                tableBody.appendChild(row);
            });

            // Add total row
            const totalRow = document.createElement("tr");
            totalRow.innerHTML = `
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td style="text-align: left; font-weight: bold;">Total FTE</td>
                <td style="font-weight: bold;">${totalMonthlyEffort.toFixed(2)}</td>
                <td style="font-weight: bold;">${totalFTE.toFixed(3)}</td>
            `;
            tableBody.appendChild(totalRow);

            // Add event listeners to inputs
            document.querySelectorAll('input[type="number"]').forEach(input => {
                input.addEventListener("input", (e) => {
                    const index = e.target.getAttribute("data-index");
                    activities[index].systems = parseFloat(e.target.value) || 0;
                    calculateAndRenderTable(); // Re-render table
                });
            });
        }

        calculateAndRenderTable(); // Initial render
    </script>
</body>
</html>
